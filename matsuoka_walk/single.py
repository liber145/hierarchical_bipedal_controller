import os

from matsuoka_walk import oscillator_nw, Logger, log
from matsuoka_walk.oscillator_2 import oscillator_nw as oscillator_nw2
from matsuoka_walk.oscillator_3 import oscillator_nw as oscillator_nw3
from matsuoka_walk.oscillator_3_eval import oscillator_nw as oscillator_nw3_1
from matsuoka_walk.oscillator_3 import oscillator_nw as oscillator_nw3
from matsuoka_walk.oscillator_5 import oscillator_nw as oscillator_nw5

import numpy as np

# Set the home directory
home_dir = os.path.expanduser('~')

# Set the logging variables
# This also creates a new log file
Logger(log_dir=os.path.join(home_dir, '.bio_walk/logs/'), log_flag=True)

# 24.08.2017 Serial# 11
chromosome_11 = [0.2809894424800271, 0.010641287858841346, 0.3536042565675742, 0.6866544967236521, 0.06227416763355498, 0.37395409236022054, 0.548276625368456, -0.22209817512550967, 0.2406521294673183, -0.14720850416137943, 0.42069906316742134]

# Serial# 12 Open loop
# Overall best chromosome after gen 21
chromosome_12_best = [0.5884145884963005, 0.5369511850955603, 0.05524939367537715, 0.025252652932915343, 0.3493674052847861, 0.15003845298477264, 0.8168417842597174, -0.3021960037316898, 0.27767678286808256, -0.08093276016328882, 0.06397013154851627]
chromosome_12_39 = [0.5884145884963005, 0.5546389061322409, 0.06503765398376404, 0.025252652932915343, 0.3493674052847861, 0.15003845298477264, 0.9355555608397872, -0.3818682418656224, 0.28272635930326756, -0.08093276016328882, 0.28736398799069907]
# Gen 30 shows a good enough walk
chromosome_12_30 = [0.5884145884963005, 0.5369511850955603, 0.09131337379133, 0.025252652932915343, 0.3493674052847861, 0.15003845298477264, 0.9377263350996107, -0.3099780890687065, 0.28272635930326756, -0.08259435820020733, 0.22178117552852405]
chromosome_16 = [0.5906406229046759, 0.7183089896427572, 0.1341955351477535, 0.32810858432009504, 0.8491296082368245, 0.2160819134026336, 0.34564741214994854, -0.1099731914045623, 0.4243372736928702, -0.26634940163067344, 0.4380152785516842]
#oscillator_nw2(chromosome_16, max_time=60.0)


#chromosome_13 = [0.2622250290596007, 0.7366434517971292, 0.10563701968664051, 0.13846196212088752, 0.7746070841755859, 0.010347844024124576, 0.1500774281387774, -0.003881588885965126, 0.03256956870647948, -0.06417349167505343, 0.6361679562895832, 0.8598499950480331]


# Angle feedback
# Best ever after gen 25
chromosome_14_best = [0.7461913734531209, 0.8422944031253159, 0.07043758116681641, 0.14236621222553963, 0.48893497409925746, 0.5980055418720059, 0.740811806645801, -0.11618361090424223, 0.492832184960149, -0.2949145038394889, 0.175450703085948, -0.3419733470484183]
# More than 2m, has not fallen - dont use
# chromosome_14_1 = [0.746191373453, 0.842294403125, 0.0704375811668, 0.0236283438094, 0.691052361025, 0.283076039513, 0.201727074382, -0.0571819786562, 0.0729859813752, -0.065040277261, 0.175450703086, -0.341973347048 ]
# Gen 30 shows a good enough walk
chromosome_14_30 = [0.746191373453, 0.842294403125, 0.0481025565348, 0.132100925761, 0.691052361025, 0.598005541872, 0.201727074382, -0.116183610904, 0.489361835504, -0.311722810344, 0.55840755813, -0.341973347048]

# run from wtmpc23 (log_20170928_104617.txt)
chromosome_17_18 = [0.25875216890878, 0.4261374577115516, 0.14424351823067832, 0.17757054603689745, 0.8075006509666804, 0.12160111156716906, 0.40977998188906734, -0.021616209300347883, 0.024680402602446694, -0.04799183022530174, 0.5084440214074175, 0.09969871880221692]
chromosome_wtmpc23 = [0.2644022508682281, 0.4552126979693223, 0.012467129675918318, 0.03828988554695599, 0.7340750027962866, 0.26151421276068004, 0.9463092817659473, -0.0741996127978023, 0.1795014887697381, -0.15164263559891972, 0.4936867546872986, 1.0719839943269078]
chromosome_20_best = [0.6450404705811301, 0.7693348395420826, 0.019270973206137753, 0.09411469737444257, 0.49928395481568916, 0.3631655506638598, 0.4917977003145482, -0.333420483018255, 0.46330629494181336, -0.21254793707792774, 0.01824073139337634, -0.17826436059862738]

oscillator_nw3(chromosome_wtmpc23, max_time=60.0)

# Testing if the gain change does turn the robot
# test_iters = 100
# avg_right = list()
# for i in range(test_iters):
#     # Right leg has smaller stride, go right
#     y = oscillator_3_test_yaw(chromosome_14_best, max_time=20.0, gain_l=1.0, gain_r=0.7)
#     avg_right.append(y)
#     log('[Test right] iteration: {0} y_dev: {1}'.format(i, y))
#
# avg_straight = list()
# for j in range(test_iters):
#     # Go straight
#     y = oscillator_3_test_yaw(chromosome_14_best, max_time=20.0, gain_l=1.0, gain_r=1.0)
#     avg_straight.append(y)
#     log('[Test straight] iteration: {0} y_dev: {1}'.format(j, y))
#
# avg_left = list()
# for k in range(test_iters):
#     # Left leg has smaller stride, go left
#     y = oscillator_3_test_yaw(chromosome_14_best, max_time=20.0, gain_l=0.7, gain_r=1.0)
#     avg_left.append(y)
#     log('[Test left] iteration: {0} y_dev: {1}'.format(k, y))
#
# log('[Test results] Left: {0}, Straight: {1}, Right: {2}'.format(np.mean(avg_left), np.mean(avg_straight), np.mean(avg_right)))

# Phase reset
# Best ever after gen 16
# Best ever individual
chromosome_15_best = [0.5146344913630376, 0.7455092402318735, -0.0070835220642929495, 0.13405758327500758, 0.6090967083734895, 0.6937935725821373, 0.21053517408377884, -0.3906102732254958, 0.4640728729649564, -0.23084688159919053, 0.7871274895040696]
# Best individual after 44 generations - shows the best walk
# chromosome_15_44 = [0.525773820572072, 0.7455092402318735, -0.0070835220642929495, 0.11122944383094965, 0.45329367561406486, 0.36757287747454864, 0.09138401154177767, -0.3906102732254958, 0.48870071798756914, -0.21725902225321198, 0.1259636974886932]
# chromosome_15_35 = [0.5146344913630376, 0.7455092402318735, 0.013249201450675324, 0.11122944383094965, 0.45329367561406486, 0.36757287747454864, 0.09138401154177767, -0.3906102732254958, 0.48870071798756914, -0.22819402334346867, 0.11514607350697748]
# Generation 30 shows as good a walk as generation 44
chromosome_15_30 = [0.5146344913630376, 0.7455092402318735, 0.02567339112892708, 0.11122944383094965, 0.45329367561406486, 0.36757287747454864, 0.21053517408377884, -0.3906102732254958, 0.48870071798756914, -0.21330757509005024, 0.11514607350697748]
#oscillator_nw5(chromosome_15_30, max_time=60.0)
chromosome_28_best = [0.8597258814566455, 0.43299754018667147, 0.14367821852476442, 0.08404019333004167, 0.7634723943690848, 0.39147229949169776, 0.11048570137787744, -0.1408267335975779, 0.08740573084913256, -0.06380256717714489, 0.08800174238458613]
#oscillator_nw(chromosome_11, max_time=60.0)

#oscillator_nw3(chromosome_14_1, max_time=60.0)
chromosome_18 = [0.23348735003280308, 0.5940097490118389, 0.046948415259721536, 0.29614276347710533, 0.5366182035136196, 0.045238888292921844, 0.7407980538549279, -0.21143743294519102, 0.27932024198484895, -0.12374820261024128, 0.937617707326727]
chromosome_18_16 = [0.6444490761087627, 0.8714565517433243, 0.23366307517466375, 0.22910610853199953, 0.8336350815504616, 0.08141310496503874, 0.3221935902098477, -0.15500792195088986, 0.2439713677828791, -0.18259633151654048, 0.8477326981496035]
#oscillator_nw5(chromosome_28_best, max_time=60.0)
